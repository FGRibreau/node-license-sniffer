#!/usr/bin/env node

var optimist = require("optimist");

var licenseSniffer = require("../");


var argv = optimist.argv;
var modulePath = argv._[0] || ".";

if (argv.recurse) {
    licenseSniffer.sniffRecursive(modulePath, function(err, licenses) {
        if (err) {
            console.error(err);
        } else {
            licenses.forEach(function(license) {
                console.log("Module: " + license.dependencyChain.join(" => "));
                console.log("License: " + license.describeLicense());
                
                if (argv.body && license.text) {
                    console.log();
                    console.log(license.text.replace(/(^|\n)/g, "$1    "));
                }
                
                console.log();
            });
        }
    });
} else {
    licenseSniffer.sniff(modulePath, function(err, license) {
        if (err) {
            console.error(err);
        } else {
            console.log(license.describeLicense());
        }
    });
}
